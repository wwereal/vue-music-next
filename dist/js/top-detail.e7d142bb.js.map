{"version":3,"sources":["webpack:///./src/components/music-list/music-list.vue","webpack:///./src/components/music-list/music-list.vue?ed54","webpack:///./src/assets/js/create-detail-component.js","webpack:///./src/components/music-list/music-list.vue?fbf0","webpack:///./src/views/top-detail.vue?51d2","webpack:///./src/components/wrap-scroll/index.js","webpack:///./src/views/top-detail.vue","webpack:///./src/views/top-detail.vue?79b7","webpack:///./src/service/top-list.js"],"names":["class","goBack","title","style","bgImageStyle","ref","playBtnStyle","random","songs","length","filterStyle","scrollStyle","probe-type","onScroll","selectItem","rank","loading","noResult","RESERVED_HEIGHT","name","components","SongList","Scroll","props","type","Array","default","String","pic","Boolean","noResultText","data","imageHeight","scrollY","maxTranslateY","computed","this","display","zIndex","paddingTop","height","translateZ","scale","Math","abs","backgroundImage","transform","bottom","playlist","top","blur","min","backdropFilter","mounted","$refs","bgImage","clientHeight","methods","$router","back","pos","y","song","index","selectPlay","list","randomPlay","render","__scopeId","createDetailComponent","key","fetch","MusicList","Object","computedData","ret","cached","storage","session","get","mid","id","$route","params","created","path","matched","push","result","processSongs","emits","ctx","h","mergeProps","$props","e","$emit","withCtx","renderSlot","$slots","setup","scrollRef","scroll","value","store","useStore","state","watch","nextTick","refresh","getTopList","getTopDetail","period"],"mappings":"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","file":"js/top-detail.e7d142bb.js","sourcesContent":["<template>\n  <div class=\"music-list\">\n\n    <div\n      class=\"back\"\n      @click=\"goBack\"\n    >\n      <i class=\"icon-back\"></i>\n    </div>\n\n    <h1 class=\"title\">{{ title }}</h1>\n\n    <div\n      class=\"bg-image\"\n      :style=\"bgImageStyle\"\n      ref=\"bgImage\"\n    >\n      <div\n        class=\"play-btn-wrapper\"\n        :style=\"playBtnStyle\"\n      >\n        <div\n          v-show=\"songs.length > 0\"\n          class=\"play-btn\"\n          @click=\"random\"\n        >\n          <i class=\"icon-play\"></i>\n          <span class=\"text\">随机播放全部</span>\n        </div>\n      </div>\n\n      <div\n        class=\"filter\"\n        :style=\"filterStyle\"\n      ></div>\n\n    </div>\n    <scroll\n      class=\"list\"\n      :style=\"scrollStyle\"\n      v-loading=\"loading\"\n      v-no-result:[noResultText]=\"noResult\"\n      :probe-type=\"3\"\n      @scroll=\"onScroll\"\n    >\n      <div class=\"song-list-wrapper\">\n        <song-list\n          :songs=\"songs\"\n          @select=\"selectItem\"\n          :rank=\"rank\"\n        ></song-list>\n      </div>\n    </scroll>\n  </div>\n</template>\n\n<script>\n  import SongList from '@/components/base/song-list/song-list'\n  import Scroll from '@/components/wrap-scroll'\n  import { mapActions, mapState } from 'vuex'\n\n  const RESERVED_HEIGHT = 40\n\n  export default {\n    name: 'music-list',\n    components: {\n      SongList,\n      Scroll\n    },\n    props: {\n      songs: {\n        type: Array,\n        default() {\n          return []\n        }\n      },\n      title: String,\n      pic: String,\n      loading: Boolean,\n      noResultText: {\n        type: String,\n        default: '抱歉，没有找到可播放的歌曲'\n      },\n      rank: Boolean\n    },\n    data() {\n      return {\n        imageHeight: 0,\n        scrollY: 0,\n        maxTranslateY: 0\n      }\n    },\n    computed: {\n      noResult() {\n        return !this.loading && !this.songs.length\n      },\n      playBtnStyle() {\n        let display = ''\n        if (this.scrollY >= this.maxTranslateY) {\n          display = 'none'\n        }\n        return {\n          display\n        }\n      },\n      bgImageStyle() {\n        const scrollY = this.scrollY\n        let zIndex = 0\n        let paddingTop = '70%'\n        let height = 0\n        let translateZ = 0\n\n        if (scrollY > this.maxTranslateY) {\n          zIndex = 10\n          paddingTop = 0\n          height = `${RESERVED_HEIGHT}px`\n          translateZ = 1\n        }\n\n        let scale = 1\n        if (scrollY < 0) {\n          scale = 1 + Math.abs(scrollY / this.imageHeight)\n        }\n\n        return {\n          zIndex,\n          paddingTop,\n          height,\n          backgroundImage: `url(${this.pic})`,\n          transform: `scale(${scale})translateZ(${translateZ}px)`\n        }\n      },\n      scrollStyle() {\n        const bottom = this.playlist.length ? '60px' : '0'\n        return {\n          top: `${this.imageHeight}px`,\n          bottom\n        }\n      },\n      filterStyle() {\n        let blur = 0\n        const scrollY = this.scrollY\n        const imageHeight = this.imageHeight\n        if (scrollY >= 0) {\n          blur = Math.min(this.maxTranslateY / imageHeight, scrollY / imageHeight) * 20\n        }\n        return {\n          backdropFilter: `blur(${blur}px)`\n        }\n      },\n      ...mapState([\n        'playlist'\n      ])\n    },\n    mounted() {\n      this.imageHeight = this.$refs.bgImage.clientHeight\n      this.maxTranslateY = this.imageHeight - RESERVED_HEIGHT\n    },\n    methods: {\n      goBack() {\n        this.$router.back()\n      },\n      onScroll(pos) {\n        this.scrollY = -pos.y\n      },\n      selectItem({ song, index }) {\n        this.selectPlay({\n          list: this.songs,\n          index\n        })\n      },\n      random() {\n        this.randomPlay(this.songs)\n      },\n      ...mapActions([\n        'selectPlay',\n        'randomPlay'\n      ])\n    }\n  }\n</script>\n\n<style lang=\"scss\" scoped>\n  .music-list {\n    position: relative;\n    height: 100%;\n    .back {\n      position: absolute;\n      top: 0;\n      left: 6px;\n      z-index: 20;\n      transform: translateZ(2px);\n      .icon-back {\n        display: block;\n        padding: 10px;\n        font-size: $font-size-large-x;\n        color: $color-theme;\n      }\n    }\n    .title {\n      position: absolute;\n      top: 0;\n      left: 10%;\n      width: 80%;\n      z-index: 20;\n      transform: translateZ(2px);\n      @include no-wrap();\n      text-align: center;\n      line-height: 40px;\n      font-size: $font-size-large;\n      color: $color-text;\n    }\n    .bg-image {\n      position: relative;\n      width: 100%;\n      transform-origin: top;\n      background-size: cover;\n      .play-btn-wrapper {\n        position: absolute;\n        bottom: 20px;\n        z-index: 10;\n        width: 100%;\n        .play-btn {\n          box-sizing: border-box;\n          width: 135px;\n          padding: 7px 0;\n          margin: 0 auto;\n          text-align: center;\n          border: 1px solid $color-theme;\n          color: $color-theme;\n          border-radius: 100px;\n          font-size: 0;\n        }\n        .icon-play {\n          display: inline-block;\n          vertical-align: middle;\n          margin-right: 6px;\n          font-size: $font-size-medium-x;\n        }\n        .text {\n          display: inline-block;\n          vertical-align: middle;\n          font-size: $font-size-small;\n        }\n      }\n      .filter {\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(7, 17, 27, 0.4);\n      }\n    }\n    .list {\n      position: absolute;\n      bottom: 0;\n      width: 100%;\n      z-index: 0;\n      .song-list-wrapper {\n        padding: 20px 30px;\n        background: $color-background;\n      }\n    }\n  }\n</style>\n","import { render } from \"./music-list.vue?vue&type=template&id=0329f946&scoped=true\"\nimport script from \"./music-list.vue?vue&type=script&lang=js\"\nexport * from \"./music-list.vue?vue&type=script&lang=js\"\n\nimport \"./music-list.vue?vue&type=style&index=0&id=0329f946&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-0329f946\"\n\nexport default script","import MusicList from '@/components/music-list/music-list'\nimport storage from 'good-storage'\nimport { processSongs } from '@/service/song'\n\nexport default function createDetailComponent(name, key, fetch) {\n  return {\n    name,\n    components: { MusicList },\n    props: {\n      data: Object\n    },\n    data() {\n      return {\n        songs: [],\n        loading: true\n      }\n    },\n    computed: {\n      computedData() {\n        let ret = null\n        const data = this.data\n        if (data) {\n          ret = data\n        } else {\n          const cached = storage.session.get(key)\n          if (cached && (cached.mid || cached.id + '') === this.$route.params.id) {\n            ret = cached\n          }\n        }\n        return ret\n      },\n      pic() {\n        const data = this.computedData\n        return data && data.pic\n      },\n      title() {\n        const data = this.computedData\n        return data && (data.name || data.title)\n      }\n    },\n    async created() {\n      const data = this.computedData\n      if (!data) {\n        const path = this.$route.matched[0].path\n        this.$router.push({\n          path\n        })\n        return\n      }\n      const result = await fetch(data)\n      this.songs = await processSongs(result.songs)\n      this.loading = false\n    }\n  }\n}\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./music-list.vue?vue&type=style&index=0&id=0329f946&lang=scss&scoped=true\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./top-detail.vue?vue&type=style&index=0&id=12e6ae34&lang=scss&scoped=true\"","import { h, mergeProps, withCtx, renderSlot, ref, computed, watch, nextTick } from 'vue'\nimport Scroll from '@/components/base/scroll/scroll'\nimport { useStore } from 'vuex'\n\nexport default {\n  name: 'wrap-scroll',\n  props: Scroll.props,\n  emits: Scroll.emits,\n  render(ctx) {\n    return h(Scroll, mergeProps({\n      ref: 'scrollRef'\n    }, ctx.$props, {\n      onScroll: (e) => {\n        ctx.$emit('scroll', e)\n      }\n    }), {\n      default: withCtx(() => {\n        return [renderSlot(ctx.$slots, 'default')]\n      })\n    })\n  },\n  setup() {\n    const scrollRef = ref(null)\n    const scroll = computed(() => {\n      return scrollRef.value.scroll\n    })\n\n    const store = useStore()\n    const playlist = computed(() => store.state.playlist)\n\n    watch(playlist, async () => {\n      await nextTick()\n      scroll.value.refresh()\n    })\n\n    return {\n      scrollRef,\n      scroll\n    }\n  }\n}\n","<template>\n  <div class=\"top-detail\">\n    <music-list\n      :songs=\"songs\"\n      :title=\"title\"\n      :pic=\"pic\"\n      :loading=\"loading\"\n      rank\n    ></music-list>\n  </div>\n</template>\n\n<script>\n  import createDetailComponent from '@/assets/js/create-detail-component'\n  import { getTopDetail } from '@/service/top-list'\n  import { TOP_KEY } from '@/assets/js/constant'\n\n  export default createDetailComponent('top-detail', TOP_KEY, getTopDetail)\n</script>\n\n<style lang=\"scss\" scoped>\n  .top-detail {\n    position: fixed;\n    z-index: 10;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    right: 0;\n    background: $color-background;\n  }\n</style>\n","import { render } from \"./top-detail.vue?vue&type=template&id=12e6ae34&scoped=true\"\nimport script from \"./top-detail.vue?vue&type=script&lang=js\"\nexport * from \"./top-detail.vue?vue&type=script&lang=js\"\n\nimport \"./top-detail.vue?vue&type=style&index=0&id=12e6ae34&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-12e6ae34\"\n\nexport default script","import { get } from './base'\n\nexport function getTopList() {\n  return get('/api/getTopList')\n}\n\nexport function getTopDetail(top) {\n  return get('/api/getTopDetail', {\n    id: top.id,\n    period: top.period\n  })\n}\n"],"sourceRoot":""}