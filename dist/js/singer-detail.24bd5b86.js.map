{"version":3,"sources":["webpack:///./src/views/singer-detail.vue","webpack:///./src/views/singer-detail.vue?8f0e","webpack:///./src/views/singer-detail.vue?bb55","webpack:///./src/components/music-list/music-list.vue","webpack:///./src/components/music-list/music-list.vue?ed54","webpack:///./src/assets/js/create-detail-component.js","webpack:///./src/components/music-list/music-list.vue?fbf0","webpack:///./src/components/wrap-scroll/index.js","webpack:///./src/service/singer.js"],"names":["class","songs","title","pic","loading","render","__scopeId","goBack","style","bgImageStyle","ref","playBtnStyle","random","length","filterStyle","scrollStyle","probe-type","onScroll","selectItem","rank","noResult","RESERVED_HEIGHT","name","components","SongList","Scroll","props","type","Array","default","String","Boolean","noResultText","data","imageHeight","scrollY","maxTranslateY","computed","this","display","zIndex","paddingTop","height","translateZ","scale","Math","abs","backgroundImage","transform","bottom","playlist","top","blur","min","backdropFilter","mounted","$refs","bgImage","clientHeight","methods","$router","back","pos","y","song","index","selectPlay","list","randomPlay","createDetailComponent","key","fetch","MusicList","Object","computedData","ret","cached","storage","session","get","mid","id","$route","params","created","path","matched","push","result","processSongs","emits","ctx","h","mergeProps","$props","e","$emit","withCtx","renderSlot","$slots","setup","scrollRef","scroll","value","store","useStore","state","watch","nextTick","refresh","getSingerList","getSingerDetail","singer"],"mappings":"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","file":"js/singer-detail.24bd5b86.js","sourcesContent":["<template>\n  <div class=\"singer-detail\">\n    <music-list\n      :songs=\"songs\"\n      :title=\"title\"\n      :pic=\"pic\"\n      :loading=\"loading\"\n    ></music-list>\n  </div>\n</template>\n\n<script>\n  import createDetailComponent from '@/assets/js/create-detail-component'\n  import { getSingerDetail } from '@/service/singer'\n  import { SINGER_KEY } from '@/assets/js/constant'\n\n  export default createDetailComponent('singer-detail', SINGER_KEY, getSingerDetail)\n</script>\n\n<style lang=\"scss\" scoped>\n  .singer-detail {\n    position: fixed;\n    z-index: 10;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    right: 0;\n    background: $color-background;\n  }\n</style>\n","import { render } from \"./singer-detail.vue?vue&type=template&id=5eec6dd6&scoped=true\"\nimport script from \"./singer-detail.vue?vue&type=script&lang=js\"\nexport * from \"./singer-detail.vue?vue&type=script&lang=js\"\n\nimport \"./singer-detail.vue?vue&type=style&index=0&id=5eec6dd6&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-5eec6dd6\"\n\nexport default script","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./singer-detail.vue?vue&type=style&index=0&id=5eec6dd6&lang=scss&scoped=true\"","<template>\n  <div class=\"music-list\">\n\n    <div\n      class=\"back\"\n      @click=\"goBack\"\n    >\n      <i class=\"icon-back\"></i>\n    </div>\n\n    <h1 class=\"title\">{{ title }}</h1>\n\n    <div\n      class=\"bg-image\"\n      :style=\"bgImageStyle\"\n      ref=\"bgImage\"\n    >\n      <div\n        class=\"play-btn-wrapper\"\n        :style=\"playBtnStyle\"\n      >\n        <div\n          v-show=\"songs.length > 0\"\n          class=\"play-btn\"\n          @click=\"random\"\n        >\n          <i class=\"icon-play\"></i>\n          <span class=\"text\">随机播放全部</span>\n        </div>\n      </div>\n\n      <div\n        class=\"filter\"\n        :style=\"filterStyle\"\n      ></div>\n\n    </div>\n    <scroll\n      class=\"list\"\n      :style=\"scrollStyle\"\n      v-loading=\"loading\"\n      v-no-result:[noResultText]=\"noResult\"\n      :probe-type=\"3\"\n      @scroll=\"onScroll\"\n    >\n      <div class=\"song-list-wrapper\">\n        <song-list\n          :songs=\"songs\"\n          @select=\"selectItem\"\n          :rank=\"rank\"\n        ></song-list>\n      </div>\n    </scroll>\n  </div>\n</template>\n\n<script>\n  import SongList from '@/components/base/song-list/song-list'\n  import Scroll from '@/components/wrap-scroll'\n  import { mapActions, mapState } from 'vuex'\n\n  const RESERVED_HEIGHT = 40\n\n  export default {\n    name: 'music-list',\n    components: {\n      SongList,\n      Scroll\n    },\n    props: {\n      songs: {\n        type: Array,\n        default() {\n          return []\n        }\n      },\n      title: String,\n      pic: String,\n      loading: Boolean,\n      noResultText: {\n        type: String,\n        default: '抱歉，没有找到可播放的歌曲'\n      },\n      rank: Boolean\n    },\n    data() {\n      return {\n        imageHeight: 0,\n        scrollY: 0,\n        maxTranslateY: 0\n      }\n    },\n    computed: {\n      noResult() {\n        return !this.loading && !this.songs.length\n      },\n      playBtnStyle() {\n        let display = ''\n        if (this.scrollY >= this.maxTranslateY) {\n          display = 'none'\n        }\n        return {\n          display\n        }\n      },\n      bgImageStyle() {\n        const scrollY = this.scrollY\n        let zIndex = 0\n        let paddingTop = '70%'\n        let height = 0\n        let translateZ = 0\n\n        if (scrollY > this.maxTranslateY) {\n          zIndex = 10\n          paddingTop = 0\n          height = `${RESERVED_HEIGHT}px`\n          translateZ = 1\n        }\n\n        let scale = 1\n        if (scrollY < 0) {\n          scale = 1 + Math.abs(scrollY / this.imageHeight)\n        }\n\n        return {\n          zIndex,\n          paddingTop,\n          height,\n          backgroundImage: `url(${this.pic})`,\n          transform: `scale(${scale})translateZ(${translateZ}px)`\n        }\n      },\n      scrollStyle() {\n        const bottom = this.playlist.length ? '60px' : '0'\n        return {\n          top: `${this.imageHeight}px`,\n          bottom\n        }\n      },\n      filterStyle() {\n        let blur = 0\n        const scrollY = this.scrollY\n        const imageHeight = this.imageHeight\n        if (scrollY >= 0) {\n          blur = Math.min(this.maxTranslateY / imageHeight, scrollY / imageHeight) * 20\n        }\n        return {\n          backdropFilter: `blur(${blur}px)`\n        }\n      },\n      ...mapState([\n        'playlist'\n      ])\n    },\n    mounted() {\n      this.imageHeight = this.$refs.bgImage.clientHeight\n      this.maxTranslateY = this.imageHeight - RESERVED_HEIGHT\n    },\n    methods: {\n      goBack() {\n        this.$router.back()\n      },\n      onScroll(pos) {\n        this.scrollY = -pos.y\n      },\n      selectItem({ song, index }) {\n        this.selectPlay({\n          list: this.songs,\n          index\n        })\n      },\n      random() {\n        this.randomPlay(this.songs)\n      },\n      ...mapActions([\n        'selectPlay',\n        'randomPlay'\n      ])\n    }\n  }\n</script>\n\n<style lang=\"scss\" scoped>\n  .music-list {\n    position: relative;\n    height: 100%;\n    .back {\n      position: absolute;\n      top: 0;\n      left: 6px;\n      z-index: 20;\n      transform: translateZ(2px);\n      .icon-back {\n        display: block;\n        padding: 10px;\n        font-size: $font-size-large-x;\n        color: $color-theme;\n      }\n    }\n    .title {\n      position: absolute;\n      top: 0;\n      left: 10%;\n      width: 80%;\n      z-index: 20;\n      transform: translateZ(2px);\n      @include no-wrap();\n      text-align: center;\n      line-height: 40px;\n      font-size: $font-size-large;\n      color: $color-text;\n    }\n    .bg-image {\n      position: relative;\n      width: 100%;\n      transform-origin: top;\n      background-size: cover;\n      .play-btn-wrapper {\n        position: absolute;\n        bottom: 20px;\n        z-index: 10;\n        width: 100%;\n        .play-btn {\n          box-sizing: border-box;\n          width: 135px;\n          padding: 7px 0;\n          margin: 0 auto;\n          text-align: center;\n          border: 1px solid $color-theme;\n          color: $color-theme;\n          border-radius: 100px;\n          font-size: 0;\n        }\n        .icon-play {\n          display: inline-block;\n          vertical-align: middle;\n          margin-right: 6px;\n          font-size: $font-size-medium-x;\n        }\n        .text {\n          display: inline-block;\n          vertical-align: middle;\n          font-size: $font-size-small;\n        }\n      }\n      .filter {\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(7, 17, 27, 0.4);\n      }\n    }\n    .list {\n      position: absolute;\n      bottom: 0;\n      width: 100%;\n      z-index: 0;\n      .song-list-wrapper {\n        padding: 20px 30px;\n        background: $color-background;\n      }\n    }\n  }\n</style>\n","import { render } from \"./music-list.vue?vue&type=template&id=0329f946&scoped=true\"\nimport script from \"./music-list.vue?vue&type=script&lang=js\"\nexport * from \"./music-list.vue?vue&type=script&lang=js\"\n\nimport \"./music-list.vue?vue&type=style&index=0&id=0329f946&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-0329f946\"\n\nexport default script","import MusicList from '@/components/music-list/music-list'\nimport storage from 'good-storage'\nimport { processSongs } from '@/service/song'\n\nexport default function createDetailComponent(name, key, fetch) {\n  return {\n    name,\n    components: { MusicList },\n    props: {\n      data: Object\n    },\n    data() {\n      return {\n        songs: [],\n        loading: true\n      }\n    },\n    computed: {\n      computedData() {\n        let ret = null\n        const data = this.data\n        if (data) {\n          ret = data\n        } else {\n          const cached = storage.session.get(key)\n          if (cached && (cached.mid || cached.id + '') === this.$route.params.id) {\n            ret = cached\n          }\n        }\n        return ret\n      },\n      pic() {\n        const data = this.computedData\n        return data && data.pic\n      },\n      title() {\n        const data = this.computedData\n        return data && (data.name || data.title)\n      }\n    },\n    async created() {\n      const data = this.computedData\n      if (!data) {\n        const path = this.$route.matched[0].path\n        this.$router.push({\n          path\n        })\n        return\n      }\n      const result = await fetch(data)\n      this.songs = await processSongs(result.songs)\n      this.loading = false\n    }\n  }\n}\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./music-list.vue?vue&type=style&index=0&id=0329f946&lang=scss&scoped=true\"","import { h, mergeProps, withCtx, renderSlot, ref, computed, watch, nextTick } from 'vue'\nimport Scroll from '@/components/base/scroll/scroll'\nimport { useStore } from 'vuex'\n\nexport default {\n  name: 'wrap-scroll',\n  props: Scroll.props,\n  emits: Scroll.emits,\n  render(ctx) {\n    return h(Scroll, mergeProps({\n      ref: 'scrollRef'\n    }, ctx.$props, {\n      onScroll: (e) => {\n        ctx.$emit('scroll', e)\n      }\n    }), {\n      default: withCtx(() => {\n        return [renderSlot(ctx.$slots, 'default')]\n      })\n    })\n  },\n  setup() {\n    const scrollRef = ref(null)\n    const scroll = computed(() => {\n      return scrollRef.value.scroll\n    })\n\n    const store = useStore()\n    const playlist = computed(() => store.state.playlist)\n\n    watch(playlist, async () => {\n      await nextTick()\n      scroll.value.refresh()\n    })\n\n    return {\n      scrollRef,\n      scroll\n    }\n  }\n}\n","import { get } from './base'\n\nexport function getSingerList() {\n  return get('/api/getSingerList')\n}\n\nexport function getSingerDetail(singer) {\n  return get('/api/getSingerDetail', {\n    mid: singer.mid\n  })\n}\n"],"sourceRoot":""}